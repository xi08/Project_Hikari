C251 COMPILER V5.60.0,  pid                                                                14/03/22  14:46:25  PAGE 1   


C251 COMPILER V5.60.0, COMPILATION OF MODULE pid
OBJECT MODULE PLACED IN .\Output\pid.obj
COMPILER INVOKED BY: C:\Keil_v5\C251\BIN\C251.EXE User\pid.c XSMALL INTR2 WARNINGLEVEL(3) BROWSE INCDIR(.\Code;.\Lib\lib
                    -raries;.\Lib\seekfree_libraries;.\Lib\seekfree_peripheral;.\User) DEFINE(USE_8701E) DEBUG PRINT(.\Output\pid.lst) OBJECT
                    -(.\Output\pid.obj) 

stmt  level    source

    1          /*  code=utf-8
    2              Project Hikari PID控制
    3          */
    4          #include "pid.h"
    5          
    6          void pidUpdate_base(volatile PID_baseNode *p)
    7          {
    8   1          p->err = p->target - p->actual;
    9   1          p->delta = p->Kp * (p->err - p->err_1) + p->Ki * p->err + p->Kd * (p->err - 2 * p->err_1 + p->err_2);
   10   1          p->output = p->actual + p->delta;
   11   1          p->err_2 = p->err_1;
   12   1          p->err_1 = p->err;
   13   1      }
   14          void pidUpdate_ext(volatile PID_extNode *p)
   15          {
   16   1          p->err = p->target - p->actual;
   17   1          // Ki
   18   1          if (abs(p->err) < p->pKi_start * p->target)
   19   1              p->pKi = 1;
   20   1          else if (abs(p->err) > p->pKi_end * p->target)
   21   1              p->pKi = 0;
   22   1          else
   23   1              p->pKi = (p->pKi_end * p->target - abs(p->err)) / (p->target * (p->pKi_end - p->pKi_start));
   24   1          // add
   25   1          p->delta = p->Kp * (p->err - p->err_1) + (p->Ki * p->pKi) * (p->err) + p->Kd * (p->err - 2 * p->err_1
             - + p->err_2);
   26   1          p->output = p->actual + p->delta;
   27   1          p->err_2 = p->err_1;
   28   1          p->err_1 = p->err;
   29   1      }


Module Information          Static   Overlayable
------------------------------------------------
  code size            =       536     ------
  ecode size           =    ------     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =    ------     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
